<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Calculate peptide reconstitution with BAC water and create printable labels">
    <meta name="author" content="PeppinLePew">
    <meta name="theme-color" content="#4a90e2">
    
    <!-- Open Graph / Facebook / LinkedIn -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peppinlepew.github.io/peptide-calculator/">
    <meta property="og:title" content="Peptide Reconstitution Calculator">
    <meta property="og:description" content="Calculate peptide reconstitution with BAC water and create printable labels with QR and Data Matrix codes">
    <meta property="og:image" content="https://peppinlepew.github.io/peptide-calculator/favicon.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Peptide Calculator Logo">
    <meta property="og:image:type" content="image/png">
    <meta property="fb:app_id" content="peptide-calculator">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://peppinlepew.github.io/peptide-calculator/">
    <meta property="twitter:title" content="Peptide Reconstitution Calculator">
    <meta property="twitter:description" content="Calculate peptide reconstitution with BAC water and create printable labels with QR and Data Matrix codes">
    <meta property="twitter:image" content="https://peppinlepew.github.io/peptide-calculator/favicon.png">
    
    <!-- Favicon -->
    <link rel="icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="favicon.png">
    
    <title>Péppin' Lê Pew - Peptide Reconstitution Calculator</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="canonical" href="https://github.io/YOUR_USERNAME/peptide-calculator/">
    <script src="https://cdn.jsdelivr.net/npm/bwip-js@3.4.0/dist/bwip-js-min.js"></script>
</head>
<body>
    <div class="container">
        <div class="logo-container" style="text-align: center; margin-bottom: 20px;">
            <img src="favicon.png" alt="Péppin' Lê Pew Logo" width="100" style="border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
        </div>
        <h1>Péppin' Lê Pew</h1>
        <h2 style="text-align: center; margin-top: -1rem; margin-bottom: 1.5rem; color: #666; font-size: 1.2rem;">The Ultimate Peptide Reconstitution Calculator</h2>
        <div class="motivation-note">
            <p>This calculator simplifies peptide reconstitution by determining the precise amount of BAC water needed to achieve clean, round numbers of units per dose. No more mental math or imprecise measurements!</p>
        </div>
        <!-- Tabs -->
        <div class="tab-buttons" role="tablist" aria-label="Sections">
            <button id="tab-btn-calculator" class="tab-button active" role="tab" aria-selected="true" aria-controls="tab-calculator">Calculator</button>
            <button id="tab-btn-instructions" class="tab-button" role="tab" aria-selected="false" aria-controls="tab-instructions">Reconstitution Instructions</button>
            <button id="tab-btn-labels" class="tab-button" role="tab" aria-selected="false" aria-controls="tab-labels">Label Generator</button>
        </div>

        <div id="tab-calculator" class="tab-content active" role="tabpanel" aria-labelledby="tab-btn-calculator">
        <div class="calculator-card">
            <div class="input-group" style="display: flex; gap: 1rem; flex-wrap: wrap; width: 100%;">
                <div style="flex: 2; min-width: 300px; max-width: 100%;">
                    <label for="vialQuantitySelect">Quantity of Peptide in Vial (mg)</label>
                    <div class="input-wrapper" style="display: flex; gap: 0.5rem; align-items: center;">
                        <select id="vialQuantitySelect" style="flex: 1;"></select>
                        <input type="number" id="vialQuantityCustom" min="0" step="0.1" placeholder="Enter custom quantity" style="display:none; flex: 1;">
                        <span class="unit">mg</span>
                    </div>
                </div>
                <div style="flex: 1; min-width: 300px; max-width: 100%;">
                    <label for="numVialsSelect">Number of Vials</label>
                    <div class="input-wrapper" style="display: flex; gap: 0.5rem; align-items: center;">
                        <select id="numVialsSelect" style="flex: 1;"></select>
                        <input type="number" id="numVialsCustom" min="1" step="1" placeholder="Enter custom number" style="display:none; flex: 1;">
                        <span class="unit">vials</span>
                    </div>
                </div>
            </div>
            <div class="input-group">
                <label for="doseSelect">Peptide Dose (mg)</label>
                <div class="input-wrapper" style="display: flex; gap: 0.5rem; align-items: center;">
                    <select id="doseSelect" style="flex: 1;"></select>
                    <input type="number" id="doseCustom" min="0" step="0.1" placeholder="Enter custom dose" style="display:none; flex: 1;">
                    <span class="unit">mg</span>
                </div>
            </div>
            <div class="input-group">
                <label for="concentrationSelect">Concentration</label>
                <div class="input-wrapper" style="display: flex; gap: 0.5rem; align-items: center;">
                    <select id="concentrationSelect" style="flex: 1;"></select>
                    <input type="number" id="concentrationCustom" min="0" step="0.1" placeholder="Enter custom concentration" style="display:none; flex: 1;">
                    <span class="unit">mg/ml</span>
                </div>
                <span class="field-warning" id="concentrationWarning" style="display:none; color: #dc3545; font-size: 0.9em; margin-top: 0.25rem;"></span>
            </div>
            <div class="input-group">
                <label for="unitsSelect">Units per Dose</label>
                <div class="input-wrapper" style="display: flex; gap: 0.5rem; align-items: center;">
                    <select id="unitsSelect" style="flex: 1;"></select>
                    <input type="number" id="unitsCustom" min="0" step="0.1" placeholder="Enter custom units" style="display:none; flex: 1;">
                    <span class="unit">units</span>
                </div>
                <span class="field-warning" id="unitsWarning" style="display:none; color: #dc3545; font-size: 0.9em; margin-top: 0.25rem;"></span>
            </div>
            <div class="input-group" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <label for="bacWaterPerVialInput">BAC Water per Vial</label>
                    <div class="input-wrapper">
                        <input type="number" id="bacWaterPerVialInput" min="0" step="0.1" readonly>
                        <span class="unit">ml</span>
                    </div>
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label for="bacWaterTotalInput">BAC Water Total</label>
                    <div class="input-wrapper">
                        <input type="number" id="bacWaterTotalInput" min="0" step="0.1" readonly>
                        <span class="unit">ml</span>
                    </div>
                </div>
                <span class="field-warning" id="bacWaterWarning" style="display:none; color: #dc3545; font-size: 0.9em; margin-top: 0.25rem; width: 100%;"></span>
            </div>
            <div class="input-group" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <label for="dosesPerLyophilizedVialInput">Doses per Lyophilized Vial</label>
                    <div class="input-wrapper">
                        <input type="number" id="dosesPerLyophilizedVialInput" min="0" step="0.1" readonly>
                        <span class="unit">doses</span>
                    </div>
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label for="dosesPerFinalVialInput">Doses per Final Vial/cartridge</label>
                    <div class="input-wrapper">
                        <input type="number" id="dosesPerFinalVialInput" min="0" step="0.1" readonly>
                        <span class="unit">doses</span>
                    </div>
                </div>
            </div>
            <p id="warningMessage" class="warning-message" style="display:none;">Warning: Calculated concentration exceeds the recommended maximum threshold.</p>
        </div>
        </div>

        <div id="tab-instructions" class="tab-content" role="tabpanel" aria-labelledby="tab-btn-instructions">
        <div class="calculator-card">
            <h2>Reconstitution Instructions</h2>
            <div class="instructions-content" style="padding: 1rem; background-color: #f8f9fa; border-radius: 8px;">
                <div style="display:flex; justify-content:flex-end; margin-bottom: 0.75rem;">
                    <button id="printInstructionsButton" class="secondary-button" type="button">Print Instructions</button>
                </div>
                <div style="margin-bottom: 1rem; padding: 1rem; background-color: #e9ecef; border-radius: 4px;">
                    <strong>Summary:</strong>
                    <ul style="margin: 0.5rem 0 0 0;">
                        <li>Number of vials: <span id="numVialsDisplay">X</span></li>
                        <li>Peptide per vial: <span id="peptidePerVialDisplay">X</span> mg</li>
                        <li>Total BAC Water: <span id="bacWaterTotalDisplay">X</span> ml</li>
                        <li>Final Concentration: <span id="finalConcentrationDisplay">X</span> mg/ml</li>
                        <li>Total peptide in final cartridge: <span id="totalPeptideDisplay">X</span> mg</li>
                    </ul>
                </div>

                <h3 style="margin-top: 0.5rem;">Gather materials</h3>
                <ul>
                    <li>3 × ⅝” needles</li>
                    <li>1 × 1 ½” needle</li>
                    <li>sterile alcohol wipes</li>
                    <li>1 × 3 ml syringe</li>
                    <li>1 × sterile 0.22μm filter</li>
                    <li><span id="materialsVialsCount">X</span> peptide vials containing <span id="materialsMgPerVial">X</span> mg each</li>
                    <li>Target concentration: <span id="materialsConcentration">X</span> mg/ml</li>
                    <li>Total BAC water: <span id="materialsTotalBac">X</span> ml, plus some extra for purging and flushing</li>
                    <li>1 × sterile empty cartridge/vial</li>
                    <li>1 × pen needle</li>
                </ul>

                <div style="margin: 1rem 0; padding: 1rem; background-color: #e9f7ef; border: 1px solid #cdebd8; border-radius: 6px;">
                    <strong>This technique has the following benefits:</strong>
                    <ul style="margin: 0.5rem 0 0 0;">
                        <li>✅ fully purges filters of any size. No need to think about hold-back volume</li>
                        <li>✅ keeps the BAC vial as uncontaminated as possible</li>
                        <li>✅ prevents contamination of the cartridge</li>
                    </ul>
                </div>

                <ol style="margin: 0; padding-left: 1.5rem;">
                    <li>Sanitize everything with 70% IPA</li>
                    <li>Wipe down the cartridge and vial tops with sterile wipes</li>
                    <li>Draw up <span id="totalBacDisplay">X</span> ml + <span id="primingReserveDisplay">0.3</span> ml = <strong><span id="drawUpAmountDisplay">X</span> ml</strong> of BAC, or more</li>
                    <li>Attach filter and ⅝” needle to BAC. Purge all air out of filter and needle</li>
                    <li>Insert the needle + filter into the cart. Leave this needle + filter in the cart until the entire process is complete</li>
                    <li>Remove the syringe (with all remaining BAC) from the filter, leaving the filter attached to the cart</li>
                    <li>Attach a new 1 ½” needle</li>
                    <li>Purge so there is <strong><span id="purgeDownToDisplay">X</span> ml</strong> left in the syringe. Note: we’re reserving <span id="finalFlushReserveDisplay">0.5</span> ml for the final filter flush</li>
                    <li>Split that <span id="splitVolumeDisplay">X</span> ml evenly between the peptide vials. That’s approximately <strong><span id="splitVolumePerVialDisplay">X</span> ml</strong> in each vial. The syringe should now be empty</li>
                    <li>Cap the needle. Swirl the vials gently and wait 30 minutes, or at least 10 minutes more than you think you should (this allows microsocopic particles to dissolve)</li>
                    <li>Uncap the needle and draw up the <span id="splitVolumeDisplay_2">X</span> ml of dissolved peptide solution from all the vials</li>
                    <li>Remove the needle and discard it</li>
                    <li>Get your ⅝” vent needle ready</li>
                    <li>Attach the syringe to the filter/cart</li>
                    <li>Gently press about <strong><span id="preVentPressInVolumeDisplay">0.5</span> ml</strong> into the cart to create slight positive pressure. Do not over-pressurize or you risk blowing the plug out the bottom of the cartridge.  The amount is not critical.</li>
                    <li>Insert a ⅝” needle as a vent into the cart. Doing it in this order minimizes contamination risk; internal pressure keeps airflow one direction in the vent needle</li>
                    <li>Finish injecting the rest of the peptide solution into the cart. Venting prevents excess pressure buildup</li>
                    <li>We are still <strong><span id="finalFlushReserveDisplay_2">0.5</span> ml</strong> short. Using a new ⅝” needle (never reuse a needle in the BAC vial), draw up <span id="finalFlushReserveDisplay_3">0.5</span> ml of BAC water. Disconnect that needle and discard it, reattach the syringe to the filter, and push the last <span id="finalFlushReserveDisplay_4">0.5</span> ml through to flush the filter</li>
                    <li>Remove the vent needle and the filter needle</li>
                    <li>Attach a pen needle and purge all air from the cart</li>
                    <li>Detach the pen needle and discard. You're ready to go!</li>
                </ol>
            </div>
        </div>
        </div>

        <div id="tab-labels" class="tab-content" role="tabpanel" aria-labelledby="tab-btn-labels">
        <div class="calculator-card">
            <h2>Label Generator</h2>
            <div class="input-group">
                <label for="labelInput">Label</label>
                <input type="text" id="labelInput" placeholder="eg. JHT T-30" style="width: 100%;">
            </div>
            <div class="input-group">
                <label for="dateInput">Date</label>
                <input type="date" id="dateInput">
            </div>
            <div class="input-group">
                <label for="urlInput">URL for the COA</label>
                <input type="url" id="urlInput" placeholder="eg. results URL" style="width: 100%;">
                <div id="shortenedUrlDisplay" class="shortened-url"></div>
                <div style="font-size: 0.9em; color: #666; margin-top: 0.5rem;">
                    <em>Tip: Using a shortened URL creates a simpler QR code that's easier to print clearly on small labels.</em>
                </div>
            </div>
            
            <!-- Canvas for Data Matrix code generation (hidden) -->
            <canvas id="dataMatrixCanvas" style="display:none;"></canvas>
            
            <div id="labels-container">
                <h3>Labels (Click to Open)</h3>
                <h4>Reconstituted Vials</h4>
                <div class="labels-grid">
                    <div class="label-container qr-label">
                        <h4>QR Code</h4>
                    </div>
                    <div class="label-container datamatrix-label">
                        <h4>Data Matrix</h4>
                    </div>
                </div>
                
                <h4 style="margin-top: 2rem;">Un-reconstituted Vials</h4>
                <div class="labels-grid">
                    <div class="label-container unrecon-qr-label">
                        <h4>QR Code</h4>
                    </div>
                    <div class="label-container unrecon-datamatrix-label">
                        <h4>Data Matrix</h4>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>
    <script src="script.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <h3>Contribute</h3>
                <p>This calculator is an open source project. Have ideas for improvements or new features?</p>
                <ul>
                    <li>Dynamic thresholds for concentration warnings</li>
                    <li>Support for more label sizes and templates</li>
                    <li>Additional calculation methods for peptides</li>
                </ul>
                <p>View the project on <a href="https://github.com/peppinlepew/peptide-calc" target="_blank">GitHub</a> to contribute or suggest changes.</p>
                
                <div class="privacy-note" style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #eee; font-size: 0.9rem; color: #666;">
                    <h4>Privacy Note</h4>
                    <p>This application stores your calculator settings in your browser's local storage so they can be restored when you return. This data never leaves your device, is never shared with any server, and cannot be used for tracking or analytics. You can clear this data at any time by clearing your browser's local storage or history.</p>
                    <button id="resetSettingsButton" style="margin-top: 1rem; padding: 0.5rem 1rem; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">Reset All Settings</button>
                </div>
            </div>
        </div>
    </footer>
    <style>
    @media (max-width: 600px) {
        .input-wrapper {
            flex-direction: row !important;
            align-items: center !important;
            gap: 0.5rem !important;
        }
        .input-wrapper select,
        .input-wrapper input {
            width: auto !important;
            min-width: 0 !important;
            flex: 1 !important;
        }
        .input-wrapper .unit {
            flex-shrink: 0 !important;
        }
    }

    /* iPhone specific adjustments */
    @media screen and (max-width: 428px) {
        .calculator-card {
            padding: 1rem !important;
        }
        .input-group {
            padding: 0.5rem !important;
        }
        .input-group > div {
            min-width: 100% !important;
            max-width: 100% !important;
        }
        .input-wrapper {
            width: 100% !important;
        }
        .input-wrapper select,
        .input-wrapper input {
            width: auto !important;
            box-sizing: border-box !important;
        }
    }

    .input-wrapper select,
    .input-wrapper input {
        min-width: 120px;
    }
    </style>
</body>
</html>
